{
	"id": "CVE-2024-57849",
	"description": "In the Linux kernel, the following vulnerability has been resolved:  s390/cpum_sf: Handle CPU hotplug remove during sampling  CPU hotplug remove handling triggers the following function call sequence:     CPUHP_AP_PERF_S390_SF_ONLINE  --> s390_pmu_sf_offline_cpu()    ...    CPUHP_AP_PERF_ONLINE          --> perf_event_exit_cpu()  The s390 CPUMF sampling CPU hotplug handler invokes:   s390_pmu_sf_offline_cpu()  +-->  cpusf_pmu_setup()        +--> setup_pmc_cpu()             +--> deallocate_buffers()  This function de-allocates all sampling data buffers (SDBs) allocated for that CPU at event initialization. It also clears the PMU_F_RESERVED bit. The CPU is gone and can not be sampled.  With the event still being active on the removed CPU, the CPU event hotplug support in kernel performance subsystem triggers the following function calls on the removed CPU:    perf_event_exit_cpu()   +--> perf_event_exit_cpu_context()        +--> __perf_event_exit_context() \t    +--> __perf_remove_from_context() \t         +--> event_sched_out() \t              +--> cpumsf_pmu_del() \t                   +--> cpumsf_pmu_stop()                                 +--> hw_perf_event_update()  to stop and remove the event. During removal of the event, the sampling device driver tries to read out the remaining samples from the sample data buffers (SDBs). But they have already been freed (and may have been re-assigned). This may lead to a use after free situation in which case the samples are most likely invalid. In the best case the memory has not been reassigned and still contains valid data.  Remedy this situation and check if the CPU is still in reserved state (bit PMU_F_RESERVED set). In this case the SDBs have not been released an contain valid data. This is always the case when the event is removed (and no CPU hotplug off occured). If the PMU_F_RESERVED bit is not set, the SDB buffers are gone.",
	"scope": "local",
	"packages": [
		{
			"name": "linux",
			"status": "resolved",
			"urgency": "not yet assigned",
			"fixed_version": "6.1.123-1",
			"repository": [
				{
					"name": "bookworm-security",
					"version": "6.1.119-1"
				},
				{
					"name": "bookworm",
					"version": "6.1.123-1"
				}
			]
		}
	]
}
