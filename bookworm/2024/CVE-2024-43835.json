{
	"id": "CVE-2024-43835",
	"description": "In the Linux kernel, the following vulnerability has been resolved:  virtio_net: Fix napi_skb_cache_put warning  After the commit bdacf3e34945 (\"net: Use nested-BH locking for napi_alloc_cache.\") was merged, the following warning began to appear:  \t WARNING: CPU: 5 PID: 1 at net/core/skbuff.c:1451 napi_skb_cache_put+0x82/0x4b0  \t  __warn+0x12f/0x340 \t  napi_skb_cache_put+0x82/0x4b0 \t  napi_skb_cache_put+0x82/0x4b0 \t  report_bug+0x165/0x370 \t  handle_bug+0x3d/0x80 \t  exc_invalid_op+0x1a/0x50 \t  asm_exc_invalid_op+0x1a/0x20 \t  __free_old_xmit+0x1c8/0x510 \t  napi_skb_cache_put+0x82/0x4b0 \t  __free_old_xmit+0x1c8/0x510 \t  __free_old_xmit+0x1c8/0x510 \t  __pfx___free_old_xmit+0x10/0x10  The issue arises because virtio is assuming it's running in NAPI context even when it's not, such as in the netpoll case.  To resolve this, modify virtnet_poll_tx() to only set NAPI when budget is available. Same for virtnet_poll_cleantx(), which always assumed that it was in a NAPI context.",
	"scope": "local",
	"packages": [
		{
			"name": "linux",
			"status": "resolved",
			"urgency": "not yet assigned",
			"fixed_version": "6.1.112-1",
			"repository": [
				{
					"name": "bookworm",
					"version": "6.1.106-3"
				},
				{
					"name": "bookworm-security",
					"version": "6.1.112-1"
				}
			]
		}
	]
}
