{
	"id": "CVE-2024-42104",
	"description": "In the Linux kernel, the following vulnerability has been resolved:  nilfs2: add missing check for inode numbers on directory entries  Syzbot reported that mounting and unmounting a specific pattern of corrupted nilfs2 filesystem images causes a use-after-free of metadata file inodes, which triggers a kernel bug in lru_add_fn().  As Jan Kara pointed out, this is because the link count of a metadata file gets corrupted to 0, and nilfs_evict_inode(), which is called from iput(), tries to delete that inode (ifile inode in this case).  The inconsistency occurs because directories containing the inode numbers of these metadata files that should not be visible in the namespace are read without checking.  Fix this issue by treating the inode numbers of these internal files as errors in the sanity check helper when reading directory folios/pages.  Also thanks to Hillf Danton and Matthew Wilcox for their initial mm-layer analysis.",
	"scope": "local",
	"packages": [
		{
			"name": "linux",
			"status": "resolved",
			"urgency": "not yet assigned",
			"fixed_version": "6.9.9-1",
			"repository": [
				{
					"name": "sid",
					"version": "6.12.5-1"
				}
			]
		}
	]
}
